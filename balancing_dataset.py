import pandas as pd
import numpy
import pickle

#Load the unbalanced_data.pkl having the feature also as a column
with open('unbalanced_data.pkl','rb') as f:
    un_df=pickle.load(f)

#Read all the different sounds dataframe generated by running the seperating_diff_sound.py
#explosion_sounds
with open('Explosion_sounds.pkl','rb') as f:
    explosion=pickle.load(f)
#Motor_sounds
with open('Motor_sounds.pkl','rb') as f:
    motor=pickle.load(f)
#nature_sounds
with open('Nature_sounds.pkl','rb') as f:
    nature=pickle.load(f)
#human_sounds
with open('Human_sounds.pkl','rb') as f:
    human=pickle.load(f)
#wood_sounds
with open('Wood_sounds,pkl','rb') as f:
    wood=pickle.load(f)


#Balancing the audiosets by selecting the  equal number of examples from different Sounds.
# we have shown 3k examples for each as test experiment. You can change for your desired number of examples within the limit.
sub_explosion=explosion.iloc[:3000][:]
sub_motor=motor.iloc[:3000][:]
sub_nature=nature.iloc[:3000][:]
sub_human=human.iloc[:3000][:]
sub_wood=human.iloc[:3000][:]


#concatenating all the subsets of the dataframe to form a balanced dataset.
bal_df=pd.concat([sub_explosion,sub_motor,sub_nature,sub_human,sub_wood],ignore_index=True)

#save the balanced dataframe into a pickle file. It will be used while training the model
with open('balanced_data.pkl','w') as f:
    pickle.dump(bal_df,f)
